jQuery(function(d){if("undefined"==typeof wcsatt_cart_params)return!1;var t=d(document),p=d(document.body);t.on("change",".wcsatt-options-cart [name^=convert_to_sub]",function(){var s=d(this),o=d("div.cart_totals"),r=d("table.shop_table.cart"),n=s.closest(".wcsatt-options-cart"),i=r.closest(".woocommerce"),t=o.find("input.wcsatt-add-cart-to-subscription-action-input"),a=s.val(),_=r.find('input[name="_wp_http_referer"]').val();i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var c={security:wcsatt_cart_params.update_cart_option_nonce,subscription_scheme:a,add_to_subscription_checked:t.is(":checked")?"yes":"no",action:"wcsatt_update_cart_option"};d.post(wcsatt_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",c.action),c,function(t){var a,c,e;"success"===t.result?(c=(a=d(d.parseHTML(t.html))).find("div.cart_totals"),e=a.find("table.shop_table.cart"),_&&e.find('input[name="_wp_http_referer"]').val(_),e.find('input[name="update_cart"]').prop("disabled",!0),o.replaceWith(c),r.replaceWith(e),i.trigger("wcsatt_updated_cart"),p.trigger("updated_cart_totals")):(window.alert(wcsatt_cart_params.i18n_update_cart_sub_error),t.reset_to_scheme&&(s.is(":radio")?n.find('input[value="'+t.reset_to_scheme+'"]').prop("checked",!0):s.val(t.reset_to_scheme))),i.unblock()})}),t.on("change",".wcsatt-add-cart-to-subscription-action-input",function(){var t,a=d("div.cart_totals"),c=d(this),e=c.closest(".wcsatt-add-cart-to-subscription-wrapper"),s=e.find(".wcsatt-add-cart-to-subscription-options"),o=a.find(".wcsatt-options-cart [name^=convert_to_sub]"),r=c.is(":checked"),n=o.val();r?(e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t={subscription_scheme:n,add_to_subscription_checked:c.is(":checked")?"yes":"no",action:"wcsatt_load_subscriptions_matching_cart"},d.post(wcsatt_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",t.action),t,function(t){"success"===t.result?(s.html(t.html),e.removeClass("closed"),e.addClass("open"),s.slideDown(200)):window.alert(wcsatt_cart_params.i18n_subs_load_error),e.unblock()})):(e.removeClass("open"),e.addClass("closed"),s.slideUp(200))})});