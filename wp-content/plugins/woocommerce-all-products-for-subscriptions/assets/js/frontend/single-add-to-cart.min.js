!function(g){var e,i,s,o,n,c,a,_;function t(){g(".product form.cart").each(function(){r(g(this))})}function r(t){var e;t.data("satt_script")||((e=new n(t)).initialize(),t.data("satt_script",e))}"undefined"!=typeof wcsatt_single_product_params&&(e=function(t){return new(Backbone.Model.extend({get_schemes_count:function(){var t=this.get("schemes"),e=0;for(var i in t)t.hasOwnProperty(i)&&e++;return e},get_active_scheme_key:function(){return this.get("active_scheme_key")},get_last_active_scheme_key:function(){return this.previous("active_scheme_key")},set_active_scheme:function(t){this.set({active_scheme_key:"0"!==t&&t})},set_schemes:function(t){this.set({schemes:t})},is_active_scheme_prorated:function(){return this.get_scheme_prop(this.get_active_scheme_key(),"is_prorated")},was_last_active_scheme_prorated:function(){return this.get_scheme_prop(this.get_last_active_scheme_key(),"is_prorated")},get_scheme_prop:function(t,e){var i=this.get("schemes");return void 0===i[t]||void 0===i[t][e]?null:i[t][e]},initialize:function(){this.set({schemes:{},active_scheme_key:""})}}))(t)},i=function(t){return new(Backbone.View.extend({product:!1,$el_content:!1,$el_options:!1,$el_dropdown:!1,$el_prompt:!1,$el_option_items:!1,$el_option_inputs:!1,$el_button:!1,add_to_cart_button_text:!1,sign_up_button_text:!1,prompt_type:"",variation:!1,variation_options_render_location:"price_html",events:{"change select.wcsatt-options-product-dropdown":"dropdown_scheme_changed","change .wcsatt-options-prompt-action-input":"action_link_clicked","change .wcsatt-options-product-wrapper input":"active_scheme_changed",show_variation:"variation_found",reset_data:"reset_schemes"},action_link_clicked:function(t){var e=this.model,i="one-time"===this.get_prompt_val(),s=!1;if(e.get_active_scheme_key()){if(!i)return!1;e.set_active_scheme(!1),s=this.maybe_toggle_options()}else{if(i)return!1;var o=this.$el_option_inputs.filter(":checked");"0"===o.val()?this.$el_option_inputs.filter('[value!="0"]').first().prop("checked",!0).change():e.set_active_scheme(o.val()),s=this.maybe_toggle_options()}if(!s)return!1},dropdown_scheme_changed:function(t){var e=this.$el_dropdown.val();this.$el_option_inputs.filter('[value="'+e+'"]').prop("checked",!0).change()},active_scheme_changed:function(t){this.model.set_active_scheme(t.currentTarget.value)},variation_found:function(t,e){this.$el.hasClass("variations_form")&&(this.variation=e,"before_add_to_cart_button"===this.variation_options_render_location&&this.$el_content.replaceWith(e.satt_options_html),this.initialize({$el_content:this.$el.find(".wcsatt-options-wrapper")}),"before_add_to_cart_button"===this.variation_options_render_location&&1<this.$el_option_inputs.length&&this.$el_content.slideDown(200))},variation_selected:function(){return!1!==this.variation},reset_schemes:function(){this.$el.hasClass("variations_form")&&(this.variation=!1,"before_add_to_cart_button"===this.variation_options_render_location&&this.$el_content.slideUp(200),this.model.set_schemes({}),this.model.set_active_scheme(!1))},has_schemes:function(){return 0<this.$el_content.length},has_prompt:function(t){return 0<this.$el_prompt.length&&(!t||t===this.get_prompt_type())},has_dropdown:function(){return this.$el_dropdown&&0<this.$el_dropdown.length},get_prompt_type:function(){return this.$el_prompt.data("prompt_type")},get_prompt_val:function(){var t=!1;return this.has_prompt("radio")||this.has_prompt("checkbox")?((this.has_prompt("checkbox")&&!1===this.$el_prompt.find(".wcsatt-options-prompt-action-input").is(":checked")||this.has_prompt("radio")&&this.$el_prompt.find('.wcsatt-options-prompt-action-input[value="no"]').is(":checked"))&&(t=!0),t?"one-time":"subscribe"):null},find_schemes:function(){var e={};return this.has_schemes()&&(this.$el_option_items=this.$el_options.find("li"),this.$el_option_inputs=this.$el_options.find("input"),this.$el_option_inputs.filter('[value!="0"]').each(function(){var t=g(this).data("custom_data");e[t.subscription_scheme.key]=t.subscription_scheme})),e},maybe_toggle_options:function(t){var e=this,i=(t=void 0!==t&&t)?0:200;if(!0===e.$el_content.data("animating"))return!1;if(e.$el_content.hasClass("closed")){if(e.model.get_schemes_count()<2)return!0;e.$el_content.removeClass("closed").addClass("open"),t?e.$el_options.show():(e.$el_content.data("animating",!0),setTimeout(function(){e.$el_options.slideDown({duration:i,queue:!1,always:function(){e.$el_content.data("animating",!1)}})},10))}else t?e.$el_options.hide():(e.$el_content.data("animating",!0),setTimeout(function(){e.$el_options.slideUp({duration:i,queue:!1,always:function(){e.$el_content.data("animating",!1)}})},10)),e.$el_content.removeClass("open").addClass("closed");return!0},schemes_visible:function(){return this.$el_options.is(":visible")},update_button_text:function(){this.model.get_active_scheme_key()?!this.model.get_last_active_scheme_key()&&this.sign_up_button_text&&this.$el_button.text(this.sign_up_button_text):this.model.get_last_active_scheme_key()&&this.$el_button.text(this.add_to_cart_button_text)},initialize:function(t){var e,i;this.variation_options_render_location=t.$el_content.hasClass("wcsatt-options-wrapper--variation")?"before_add_to_cart_button":"price_html",this.$el_content=t.$el_content,this.$el_options=t.$el_content.find(".wcsatt-options-product-wrapper"),this.$el_prompt=t.$el_content.find(".wcsatt-options-product-prompt"),this.$el_dropdown=t.$el_content.find(".wcsatt-options-product-dropdown"),this.model.set_schemes(this.find_schemes()),t.product&&(this.product=t.product,this.$el_button=t.product.$form.find(".single_add_to_cart_button").last(),this.add_to_cart_button_text=this.$el_button.text(),this.listenTo(this.model,"change:active_scheme_key",this.update_button_text)),this.has_schemes()?(this.sign_up_button_text=this.$el_content.data("sign_up_text"),0<(e=this.$el_option_inputs.filter('[value="'+this.model.get_active_scheme_key()+'"]')).length?e.prop("checked",!0):this.$el_option_inputs.filter(":checked").change(),this.$el_option_inputs.length<=1&&this.$el_content.hide(),this.has_dropdown()&&(this.model.get_active_scheme_key()?(this.schemes_visible()||this.maybe_toggle_options(!0),this.has_prompt("checkbox")?this.$el_prompt.find(".wcsatt-options-prompt-action-input").prop("checked",!0):this.has_prompt("radio")&&this.$el_prompt.find('.wcsatt-options-prompt-action-input[value="yes"]').prop("checked",!0)):this.model.get_active_scheme_key()||(this.schemes_visible()&&this.maybe_toggle_options(!0),this.has_prompt("checkbox")?this.$el_prompt.find(".wcsatt-options-prompt-action-input").prop("checked",!1):this.has_prompt("radio")&&this.$el_prompt.find('.wcsatt-options-prompt-action-input[value="no"]').prop("checked",!0))),this.has_dropdown()&&(i=this,setTimeout(function(){i.has_prompt("checkbox")?i.$el_prompt.find(".wcsatt-options-prompt-action-input").change():i.$el_prompt.find(".wcsatt-options-prompt-action-input").filter(":checked").change()},10))):this.variation_selected()?this.model.set_active_scheme(null):this.model.set_active_scheme(!1)}}))(t)},s=function(t){return new(Backbone.Model.extend({product:!1,xhr:!1,cached_responses:{},set_scheme_key:function(t){this.set({scheme_key:t})},get_scheme_key:function(){return this.get("scheme_key")},get_matching_subscriptions_html:function(){var e,i=this,t=this.product.schemes_model.get_active_scheme_key();this.xhr&&this.xhr.abort(),t=!1===t?"0":t,void 0!==this.cached_responses[t]?(i.set({html:this.cached_responses[t]}),i.trigger("matching_subscriptions_loaded")):(e={action:"wcsatt_load_subscriptions_matching_product",product_id:this.product.get_product_id(),subscription_scheme:t},this.xhr=g.post(wcsatt_single_product_params.wc_ajax_url.toString().replace("%%endpoint%%",e.action),e,function(t){"success"===t.result?(i.set({html:t.html}),i.cached_responses[e.subscription_scheme]=t.html):(i.set({html:!1}),i.attributes.scheme_key=!1),i.trigger("matching_subscriptions_loaded")}))},active_scheme_changed:function(){this.xhr&&this.xhr.abort()},initialize:function(t){this.product=t.product;this.set({scheme_key:"",html:!1}),this.listenTo(this.product.schemes_model,"change:active_scheme_key",this.active_scheme_changed),this.on("change:scheme_key",this.get_matching_subscriptions_html)}}))(t)},o=function(t){return new(Backbone.View.extend({$el_content:!1,product:!1,block_params:{message:null,fadeIn:0,fadeOut:0,overlayCSS:{background:"rgba( 255, 255, 255, 0 )",opacity:1}},events:{"click .wcsatt-add-to-subscription-action-input":"action_link_clicked"},action_link_clicked:function(){var t=this.model,e=this,i=!1;if(this.matching_subscriptions_visible()||this.model.get_scheme_key()===this.product.schemes_model.get_active_scheme_key()?i=this.toggle():(i=!0,this.$el.block(this.block_params),setTimeout(function(){t.set_scheme_key(e.product.schemes_model.get_active_scheme_key())},200)),!i)return!1},active_scheme_changed:function(){var t=this,e=!0;!1!==this.product.schemes_model.get_active_scheme_key()&&!this.product.schemes_model.is_active_scheme_prorated()||(e=!1),e?(t.$el.hasClass("open")&&t.model.get_scheme_key()!==t.product.schemes_model.get_active_scheme_key()&&(t.$el.block(t.block_params),!1!==t.product.schemes_model.get_last_active_scheme_key()&&!this.product.schemes_model.was_last_active_scheme_prorated()||t.toggle(!0),setTimeout(function(){t.model.set_scheme_key(t.product.schemes_model.get_active_scheme_key())},250)),setTimeout(function(){t.$el.slideDown(200).removeClass("inactive").addClass("active")},50)):this.$el.slideUp(200).removeClass("active").addClass("inactive")},add_to_subscription_button_clicked:function(t){var e=t.data.view.product.$form.find(".single_add_to_cart_button").last();if(e.hasClass("disabled"))return e.click(),!1},toggle:function(t){var e=this,i=(t=void 0!==t&&t)?0:200;return!0!==e.$el.data("animating")&&(e.$el.hasClass("closed")?(setTimeout(function(){e.$el_content.slideDown({duration:i,queue:!1,always:function(){e.$el.data("animating",!1)}})},10),e.$el.removeClass("closed").addClass("open")):(setTimeout(function(){e.$el_content.slideUp({duration:i,queue:!1,always:function(){e.$el.data("animating",!1)}})},10),e.$el.removeClass("open").addClass("closed")),e.$el.data("animating",!0),!0)},matching_subscriptions_visible:function(){return this.$el_content.is(":visible")},matching_subscriptions_loaded:function(){this.render()},render:function(){var t=this.model.get("html");this.$el.unblock(),!1===t?(window.alert(wcsatt_single_product_params.i18n_subs_load_error),this.matching_subscriptions_visible()&&this.toggle(),this.$el.find("input.wcsatt-add-to-subscription-action-input").prop("checked",!1)):(this.$el_content.html(t),this.matching_subscriptions_visible()||this.toggle())},initialize:function(t){this.product=t.product,this.$el_content=t.$el_content,this.listenTo(this.model,"matching_subscriptions_loaded",this.matching_subscriptions_loaded),this.listenTo(this.product.schemes_model,"change:active_scheme_key",this.active_scheme_changed),this.$el_content.on("click",".wcsatt-add-to-subscription-button",{view:this},this.add_to_subscription_button_clicked)}}))(t)},n=function(t){this.$form=t,this.schemes_model=!1,this.schemes_view=!1,this.matching_subscriptions_model=!1,this.matching_subscriptions_view=!1,this.initialize=function(){this.schemes_model=new e({product:this}),this.matching_subscriptions_model=new s({product:this}),this.schemes_view=new i({product:this,model:this.schemes_model,el:t,$el_content:t.find(".wcsatt-options-wrapper")}),this.matching_subscriptions_view=new o({product:this,model:this.matching_subscriptions_model,el:t.find(".wcsatt-add-to-subscription-wrapper"),$el_content:t.find(".wcsatt-add-to-subscription-options")}),-1!=window.location.href.indexOf("switch-subscription")&&-1!=window.location.href.indexOf("item")&&t.prop("action",""),t.on("submit",{view:this.schemes_view},this.form_submitted),this.pao=new c(this)},this.get_product_id=function(){return t.find(".wcsatt-add-to-subscription-wrapper").data("product_id")},this.form_submitted=function(t){var e=t.data.view;"one-time"===e.get_prompt_val()&&e.$el_option_inputs.filter('[value="0"]').prop("checked",!0)},this.round_number=function(t,e){var i=Math.pow(10,e),s=t*i;return Math.round(s)/i}},c=function(o){var n=this;this.$addons_totals=!1,this.$discount_addons_data=o.$form.find(".wcsatt-pao-data"),this.initialize=function(){var t,e;o.$form.hasClass("bundle_form")||o.$form.hasClass("composite_form")||0<(t=o.$form.find("#product-addons-total")).length&&1==t.data("show-sub-total")&&(e="yes"===this.$discount_addons_data.data("discount_addons"),this.$addons_totals=t,e?(o.schemes_view.$el_content.insertAfter(t),t.addClass("subscription-details-hidden")):o.schemes_view.$el_content.insertBefore(o.$form.find(".wc-pao-addon-container").first()),e||(o.schemes_model.on("change:active_scheme_key",this.active_scheme_changed),o.$form.on("show_variation",this.variation_changed)),o.schemes_model.get_active_scheme_key()&&this.active_scheme_changed())},this.active_scheme_changed=function(){var t=!1===o.schemes_model.get_active_scheme_key()?"0":o.schemes_model.get_active_scheme_key(),e=o.schemes_view.$el_options.find('input[value="'+t+'"]').data("custom_data"),i=!!e&&e.display_price,s=!!e&&e.raw_price;!1!==i&&!1!==s&&(n.$addons_totals.data("price",i),n.$addons_totals.data("raw-price",s),o.$form.trigger("woocommerce-product-addons-update"))},this.variation_changed=function(){n.active_scheme_changed()},this.initialize()},a=function(i){var m=this,f=i.$bundle_form.data("satt_script");this.initialize_ui=function(){0<f.schemes_view.$el_content.length&&(!1!==i.$addons_totals?i.$addons_totals.after(f.schemes_view.$el_content):i.$bundle_price.after(f.schemes_view.$el_content))},this.initialize_schemes=function(){i.satt_schemes=[],f.schemes_view.$el_option_items.filter(".subscription-option").each(function(){var t=g(this),e=t.find("input").data("custom_data");i.satt_schemes.push({$el:t,data:e})})},this.integrate=function(){f.schemes_view.has_schemes()&&(m.initialize_ui(),m.initialize_schemes(),0<i.satt_schemes.length&&(i.$bundle_data.on("woocommerce-product-bundle-updated-totals",m.update_subscription_totals),i.$bundle_data.on("woocommerce-product-bundle-validation-status-changed",m.maybe_hide_subscription_options)))},this.has_single_forced_susbcription=function(){return 1===i.satt_schemes.length&&0===f.schemes_view.$el_option_items.filter(".one-time-option").length},this.maybe_hide_subscription_options=function(){i.passes_validation()?m.has_single_forced_susbcription()||f.schemes_view.$el_content.slideDown(200):f.schemes_view.$el_content.slideUp(200)},this.update_subscription_totals=function(t,h){var l,u;h.passes_validation()&&(l=h.get_price_html(),u=g(l).html(),m.has_single_forced_susbcription()?h.$bundle_price.find(".price").html(h.satt_schemes[0].data.option_details_html.replace("%p",u)):g.each(h.satt_schemes,function(t,s){var o,e,i,n,c,a,_,r,d,p;(s.data.option_has_price||f.schemes_view.has_prompt("radio")||f.schemes_view.has_prompt("checkbox"))&&(o=g.extend(!0,{},h.price_data),e=l,i=u,s.data.subscription_scheme.has_price_filter&&("inherit"===s.data.subscription_scheme.pricing_mode&&0<s.data.subscription_scheme.discount?(g.each(h.bundled_items,function(t,e){var i=e.bundled_item_id;s.data.discount_from_regular?o.prices[i]=o.regular_prices[i]*(1-s.data.subscription_scheme.discount/100):o.prices[i]=o.prices[i]*(1-s.data.subscription_scheme.discount/100),o.addons_prices[i]=o.addons_prices[i]*(1-s.data.subscription_scheme.discount/100)}),o.base_price=o.base_price*(1-s.data.subscription_scheme.discount/100),n=h.get_addons_raw_price(),o.addons_regular_price=h.has_addons()&&"yes"===f.pao.$discount_addons_data.data("discount_addons")?n:0,o.addons_price=h.has_addons()&&"yes"===f.pao.$discount_addons_data.data("discount_addons")?n*(1-s.data.subscription_scheme.discount/100):0):"override"===s.data.subscription_scheme.pricing_mode&&(o.base_regular_price=Number(s.data.subscription_scheme.regular_price),o.base_price=Number(s.data.subscription_scheme.price)),o=h.calculate_subtotals(!1,o),o=h.calculate_totals(o),e=h.get_price_html(o),i=g(e).html()),c=s.$el.find(".subscription-price"),a=s.data.option_details_html.replace("%p",i),!s.data.subscription_scheme.is_base||!f.schemes_view.has_prompt("radio")&&!f.schemes_view.has_prompt("checkbox")||0<(_=f.schemes_view.$el_prompt.find('.wcsatt-options-prompt-action-input[value="yes"]').closest(".wcsatt-options-prompt-label").find(".wcsatt-options-prompt-action")).find(".subscription-price").length&&_.html(s.data.prompt_details_html.replace("%p",i)).find("span.total").remove(),s.data.option_has_price&&(c.html(a).find("span.total").remove(),f.schemes_view.has_dropdown()&&(p=wc_pb_price_format(o.totals.price,!0),r="",p=s.data.dropdown_format.replace("%p",p),s.data.subscription_scheme.has_price_filter&&("inherit"===s.data.subscription_scheme.pricing_mode&&0<s.data.subscription_scheme.discount?(r=f.round_number(s.data.subscription_scheme.discount,s.data.dropdown_discount_decimals),p=s.data.dropdown_discounted_format.replace("%d",r).replace("%p",p)):o.totals.regular_price>o.totals.price&&(d=wc_pb_price_format(o.totals.regular_price,!0),p=s.data.dropdown_sale_format.replace("%r",d).replace("%p",p))),f.schemes_view.$el_dropdown.find("option[value="+s.data.subscription_scheme.key+"]").text(p))),c.trigger("wcsatt-updated-bundle-price",[e,s,h,m]))}))},f&&this.integrate()},_=function(f){var b=this,v=f.$composite_form.data("satt_script");this.initialize_ui=function(){0<v.schemes_view.$el_content.length&&(!1!==f.composite_price_view.$addons_totals?f.composite_price_view.$addons_totals.after(v.schemes_view.$el_content):f.$composite_price.after(v.schemes_view.$el_content))},this.initialize_schemes=function(){f.satt_schemes=[],v.schemes_view.$el_option_items.filter(".subscription-option").each(function(){var t=g(this),e=t.find("input").data("custom_data");f.satt_schemes.push({$el:t,data:e})})},this.integrate=function(){v.schemes_view.has_schemes()&&(b.initialize_schemes(),f.actions.add_action("initialize_composite",function(){b.initialize_ui(),0<f.satt_schemes.length&&(b.has_single_forced_susbcription()?f.filters.add_filter("composite_price_html",b.filter_price_html,10,b):(f.actions.add_action("composite_totals_changed",b.update_subscription_totals,101,b),f.actions.add_action("composite_validation_status_changed",b.maybe_hide_subscription_options,101,b),f.actions.add_action("composite_initialized",b.maybe_hide_subscription_options,101,b)))},51,this))},this.has_single_forced_susbcription=function(){return 1===f.satt_schemes.length&&0===v.schemes_view.$el_option_items.filter(".one-time-option").length},this.maybe_hide_subscription_options=function(){"pass"===f.api.get_composite_validation_status()?b.has_single_forced_susbcription()||v.schemes_view.$el_content.slideDown(200):v.schemes_view.$el_content.slideUp(200)},this.filter_price_html=function(t,e,i){var s=g(t).html();return t='<p class="price">'+f.satt_schemes[0].data.option_details_html.replace("%p",s)+"</p>"},this.update_subscription_totals=function(){var l,u,m;"pass"===f.api.get_composite_validation_status()&&(l=f.composite_price_view.get_price_html(),u=f.data_model.calculate_totals(),m=g(l).html(),g.each(f.satt_schemes,function(t,s){var o,e,i,n,c,a,_,r,d,p,h;(s.data.option_has_price||v.schemes_view.has_prompt("radio")||v.schemes_view.has_prompt("checkbox"))&&(o=g.extend(!0,{},f.data_model.price_data),e=l,i=m,n=u,s.data.subscription_scheme.has_price_filter&&(b.maybe_add_bundle_totals_filters(s),"inherit"===s.data.subscription_scheme.pricing_mode&&0<s.data.subscription_scheme.discount?(g.each(f.get_components(),function(t,e){var i=e.component_id;s.data.discount_from_regular?o.prices[i]=o.regular_prices[i]*(1-s.data.subscription_scheme.discount/100):o.prices[i]=o.prices[i]*(1-s.data.subscription_scheme.discount/100),o.addons_prices[i]=o.addons_prices[i]*(1-s.data.subscription_scheme.discount/100)}),o.base_price=o.base_price*(1-s.data.subscription_scheme.discount/100),c=f.composite_price_view.get_addons_raw_price(),o.addons_regular_price=f.composite_price_view.has_addons()&&"yes"===v.pao.$discount_addons_data.data("discount_addons")?c:0,o.addons_price=f.composite_price_view.has_addons()&&"yes"===v.pao.$discount_addons_data.data("discount_addons")?c*(1-s.data.subscription_scheme.discount/100):0):"override"===s.data.subscription_scheme.pricing_mode&&(o.base_regular_price=Number(s.data.subscription_scheme.regular_price),o.base_price=Number(s.data.subscription_scheme.price)),o=f.data_model.calculate_subtotals(!1,o),b.maybe_remove_bundle_totals_filters(s),n=f.data_model.calculate_totals(o),o.totals=n,e=f.composite_price_view.get_price_html(o),i=g(e).html()),a=s.$el.find(".subscription-price"),_=s.data.option_details_html.replace("%p",i),!s.data.subscription_scheme.is_base||!v.schemes_view.has_prompt("radio")&&!v.schemes_view.has_prompt("checkbox")||0<(r=v.schemes_view.$el_prompt.find('.wcsatt-options-prompt-action-input[value="yes"]').closest(".wcsatt-options-prompt-label").find(".wcsatt-options-prompt-action")).find(".subscription-price").length&&r.html(s.data.prompt_details_html.replace("%p",i)).find("span.total").remove(),s.data.option_has_price&&(a.html(_).find("span.total").remove(),v.schemes_view.has_dropdown()&&(h=wc_cp_price_format(n.price,!0),d="",h=s.data.dropdown_format.replace("%p",h),s.data.subscription_scheme.has_price_filter&&("inherit"===s.data.subscription_scheme.pricing_mode&&0<s.data.subscription_scheme.discount?(d=v.round_number(s.data.subscription_scheme.discount,s.data.dropdown_discount_decimals),h=s.data.dropdown_discounted_format.replace("%d",d).replace("%p",h)):o.totals.regular_price>o.totals.price&&(p=wc_cp_price_format(o.totals.regular_price,!0),h=s.data.dropdown_sale_format.replace("%r",p).replace("%p",h))),v.schemes_view.$el_dropdown.find("option[value="+s.data.subscription_scheme.key+"]").text(h))),a.trigger("wcsatt-updated-composite-price",[e,s,f,b]))}))},this.maybe_add_bundle_totals_filters=function(s){"inherit"===s.data.subscription_scheme.pricing_mode&&0<s.data.subscription_scheme.discount&&g.each(f.get_components(),function(t,e){var i;"bundle"!==e.get_selected_product_type()||(i=e.get_bundle_script())&&(i.satt_scheme=s,i.filters.add_filter("bundle_totals",b.filter_bundle_totals,10,b))})},this.maybe_remove_bundle_totals_filters=function(t){"inherit"===t.data.subscription_scheme.pricing_mode&&0<t.data.subscription_scheme.discount&&g.each(f.get_components(),function(t,e){var i;"bundle"!==e.get_selected_product_type()||(i=e.get_bundle_script())&&(i.satt_scheme=!1,i.filters.remove_filter("bundle_totals",b.filter_bundle_totals))})},this.filter_bundle_totals=function(t,e,i,s){if(!i.satt_scheme)return t;var o=i.satt_scheme.data,n=o.subscription_scheme.discount,c=g.extend(!0,{},e);return s=void 0===s?i.composite_data.component.get_selected_quantity():s,g.each(i.bundled_items,function(t,e){o.discount_from_regular?c.prices[e.bundled_item_id]=c.regular_prices[e.bundled_item_id]*(1-n/100):c.prices[e.bundled_item_id]=c.prices[e.bundled_item_id]*(1-n/100)}),c.base_price&&(o.discount_from_regular?c.base_price=Number(c.base_regular_price)*(1-n/100):c.base_price=Number(c.base_price)*(1-n/100)),i.satt_scheme=!1,c=i.calculate_subtotals(!1,c,s),t=(c=i.calculate_totals(c)).totals},this.integrate()},t(),g(".bundle_form .bundle_data").each(function(){g(this).on("woocommerce-product-bundle-initializing",function(t,e){e.is_composited()||new a(e)})}),g(".composite_form .composite_data").each(function(){g(this).on("wc-composite-initializing",function(t,e){new _(e)})}),g(document.body).on("wcsatt-initialize",function(){t()}),g.fn.wcsatt_initialize=function(){g(this).find(".product form.cart").each(function(){r(g(this))})})}(jQuery);